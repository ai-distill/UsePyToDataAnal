# UsePyToDataAnal
《利用Python进行数据分析(第二版本)》

> 书上源代码：[本书源代码](<https://github.com/wesm/pydata-book>)

-------------------------------------------------------

## Chapter 4 Numpy

ndarray中，所有元素必须是相同类型的，每个数组都有一个dtype和shape(一个表示各个维度大小的**元祖**)

### 数据类型

注意：除非特别说明，否则np.array将会尝试为新建的这个数组推断出一个较为合适的数据类型。数据类型保存在一个特殊的dtype对象中。

可以通过ndarray的astype方法明确的将一个数组从一个dtype转换成另一个dtype
```Python
arr = np.array([1, 2, 3, 4, 5])
float_arr = arr.astype(np.float64)
float_arr.dtype
```

如果将浮点数类型转换为整数型，小数部分会被删除

总结：**Numpy中转换数据类型时，调用astype总会创建一个新的数组(一个数据的备份)，即使新的dtype与旧的dtype相同**

**注意：使用numpy.string_类型时，一定要小心，因为Numpy的字符串数据是大小固定的，发生截取时不会发出警告。**


### 创建新ndarray
注意：认为np.empty会返回全0数组的想法是不安全的，很多情况下返回的都是一些未初始化的垃圾值

### Numpy数组的运算
> 数组很重要，因为它使你不用编写循环即可对数据执行批量运算。Numpy用户称其为矢量化

1. 大小相等的数组之间的任何算术运算都会将运算应用到元素级
2. 数组与标量的运算会被传播到各个元素
3. 大小相同的数组之间的比较会生成布尔数组

不同大小的数组之间的运算叫做广播。

### 基本的索引和切片
当将一个标量值赋值给一个切片时，该值会自动传播到整个选区

#### 索引方式
arr2d[0][2] 等同于 arr2d[0, 2], 说明了二维数组的索引方式，轴0作为行，轴1作为列
arr3d[0][2][1] 等同于 arr3d[0, 2, 1]

#### Python中的切片和Numpy中的切片
1. Python中的切片将会赋值一个新的数组，而Numpy不是，只是在原来数组上进行操作
2. 使用Numpy中的切片，对切片进行的任何操作都会直接反映到切片所在的数组

缘由：Numpy从设计之初就是为了处理大数据，如果我们每次切片都要复制数据，将会对性能和内存造成很大的影响

### 切片索引
只有冒号表示整个轴
arr2d[:, :1] 表示选取所有的行中，列数从最开始到第1列(不包括)

### 布尔型索引

1. 布尔型数组的长度必须跟被索引的轴的长度一致
2. 布尔型数组跟切片、整数(或整数数列)混合使用
3. **~操作符**用来反转条件很好用，用来表示对条件进行否定
4. data[~(names == 'Bob')] 与 data[names != 'Bob'] 等价
5. 在布尔型索引中，可以通过组合应用多个布尔条件，使用& | 之类的布尔算术运算符即可

注意：
1. 通过布尔型索引选取数组中的数据，将总是创建数据的副本，即使返回一模一样的数组也是如此
2. Python关键字and 和 or 在布尔型数组中无效，要使用&与|


例子：将data中所有的负值都设置为0
```Python
data[data < 0] = 0
```